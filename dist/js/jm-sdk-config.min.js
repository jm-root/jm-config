var jm=jm||{};"undefined"!=typeof exports&&"undefined"!=typeof module&&(jm=require("jm-sdk-core"),require("jm-ms")),function(){var t=jm.sdk,i=t.storage,n=jm.ms,e="config";if(!t[e]){t.on("init",function(i){i[e]=i[e]||{},i[e].uri=i[e].uri||i.uri,i[e].timeout=i[e].timeout||i.timeout,t[e].init(i[e])});t.config={init:function(u){var o=this;u=u||{};var r=u.uri,s=u.prefix||"/"+e;this.uri=r+s;var c=n();o.client=c,c.use(function(t,n,e){if(t.data||(t.data={}),!t.data.token){var u=i.getItem("token")||null;u&&(t.data.token=u)}e()}),n.client({uri:this.uri,timeout:u.timeout||0},function(i,n){!i&&n&&(c.use(n),n.on("open",function(){c.emit("open"),t.emit("open",e)}),n.on("close",function(){c.emit("close"),t.emit("close",e)}))}),jm.enableEvent(this)},_getlisturi:function(t){var i=t.root||"";return"/"+i},_geturi:function(t){var i=t.key||"";return this._getlisturi(t)+"/"+i},getConfig:function(t,i){i=i||function(){},t=t||{};var n=this._geturi(t);this.client.get({uri:n},i)},setConfig:function(t,i){i=i||function(){},t=t||{};var n=this._geturi(t);this.client.post({uri:n,data:t},i)},delConfig:function(t,i){i=i||function(){},t=t||{};var n=this._geturi(t);this.client.delete({uri:n},i)},delRoot:function(t,i){i=i||function(){},t=t||{};var n=this._getlisturi(t);this.client.delete({uri:n},i)},listConfig:function(t,i){i=i||function(){},t=t||{};var n=this._getlisturi(t);t.all&&(n+="?all=1"),this.client.get({uri:n},i)},setConfigs:function(t,i){i=i||function(){},t=t||{};var n=this._geturi(t);this.client.post({uri:n,data:t},i)}}}}();